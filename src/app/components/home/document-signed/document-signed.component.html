<div class="grid">
  <div class="col-12">
    <div class="card">
      <p-toast></p-toast>

      <p-table
        #dt
        [value]="datas"
        responsiveLayout="scroll"
        [rows]="10"
        [globalFilterFields]="['documentSign', 'documentName']"
        [paginator]="true"
        [rowsPerPageOptions]="[5, 10, 20]"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [rowHover]="true"
        dataKey="idDocument"
      >
        <ng-template pTemplate="caption">
          <div
            class="flex flex-column md:flex-row md:justify-content-between md:align-items-center"
          >
            <h4 class="m-0">Inquery Document Signed</h4>
            <span class="block mt-2 md:mt-0 p-input-icon-left">
              <i class="pi pi-search"></i>
              <input
                pInputText
                type="text"
                (input)="onGlobalFilter($event, dt)"
                placeholder="Search..."
                class="w-full sm:w-auto"
              />
            </span>
          </div>
        </ng-template>
        <ng-template pTemplate="header">
          <tr>
            <th>No</th>
            <th pSortableColumn="documentSign">
              ID Document
              <p-sortIcon field="documentSign"></p-sortIcon>
            </th>
            <th pSortableColumn="documentName">
              Document Name <p-sortIcon field="documentName"></p-sortIcon>
            </th>
            <th pSortableColumn="statusSignedUser">
              Signed By <p-sortIcon field="statusSignedUser"></p-sortIcon>
            </th>
            <th>Status Sign</th>
            <th>View Document</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-data let-i="rowIndex">
          <tr>
            <td>{{ i + 1 }}</td>
            <td style="width: 25%; min-width: 10rem">
              <span class="p-column-title">Document Name</span>
              {{ data.documentSign }}
            </td>
            <td style="width: 15%; min-width: 10rem">
              <span class="p-column-title">Document Name</span>
              {{ data.documentName }}
            </td>
            <td style="width: 25%; min-width: 10rem">
              <span class="p-column-title">Signed By</span>
              {{ data.statusSignedUser }}
            </td>
            <td style="width: 10%; min-width: 10rem">
              <span class="p-column-title">Status Sign</span>
              <span [ngClass]="getStatusBadgeClass(data.signed)">{{
                data.signed ? "signed" : "need sign"
              }}</span>
            </td>
            <td style="width: 15%; min-width: 10rem">
              <button
                pButton
                class="p-button-success mr-2"
                label="View"
                icon="pi pi-fw pi-file"
                (click)="openPdfViewer(data)"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <!--View Pdf Dialog-->
    <p-dialog
      [(visible)]="pdfDialog"
      header="Preview Document"
      [modal]="true"
      [styleClass]="'p-grid p-fluid w-12 md:w-4'"
      [closable]="true"
      [draggable]="false"
    >
      <ng-template pTemplate="content">
        <ngx-extended-pdf-viewer
          [src]="pdfSrc"
          [useBrowserLocale]="true"
          class="shadow-4"
          [customToolbar]="additionalButtons"
          [height]="'70vh'"
        ></ngx-extended-pdf-viewer>

        <ng-template #additionalButtons>
          <div id="toolbarViewer">
            <div id="toolbarViewerLeft">
              <pdf-toggle-sidebar></pdf-toggle-sidebar>
              <div class="toolbarButtonSpacer"></div>
              <pdf-find-button
                [showFindButton]="true"
                [textLayer]="true"
              ></pdf-find-button>
              <pdf-paging-area></pdf-paging-area>
            </div>
            <pdf-zoom-toolbar></pdf-zoom-toolbar>
            <!-- toolbar viewer middle -->
            <div id="toolbarViewerRight">
              <pdf-download></pdf-download>
              <div class="verticalToolbarSeparator hiddenSmallView"></div>
              <pdf-toggle-secondary-toolbar></pdf-toggle-secondary-toolbar>
            </div>
          </div>
        </ng-template>
      </ng-template>
      <ng-template pTemplate="footer">
        <button
          pButton
          pRipple
          label="Close"
          icon="pi pi-times"
          class="p-button-text"
          (click)="hidePdfDialog()"
        ></button>
      </ng-template>
    </p-dialog>
  </div>
</div>
